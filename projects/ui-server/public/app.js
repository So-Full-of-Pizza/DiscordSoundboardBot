(()=>{"use strict";function t(t=!1){const e=document.getElementById("search");t&&(e.value=""),e.focus();const n=document.getElementById("search-cancel");e.value?n.classList.add("search-cancel-show"):n.classList.remove("search-cancel-show");const s=document.getElementById("empty-search-container");s.classList.remove("message-container-show");const a=Array.from(document.getElementById("btn-container").children);a.forEach((t=>t.classList.add("btn-hide"))),a.forEach((t=>{t.dataset.soundName.toUpperCase().includes(e.value.toUpperCase())&&t.classList.remove("btn-hide")})),a.every((t=>t.classList.contains("btn-hide")))&&s.classList.add("message-container-show")}function e(t,e,n){let s;return function(...a){const o=this,d=n&&!s;clearTimeout(s),s=setTimeout((()=>{s=null,n||t.apply(o,a)}),e),d&&t.apply(o,a)}}const n=e((t=>{fetch("/api/sound",{method:"POST",headers:{"Content-Type":"text/plain"},body:t.parentElement.dataset.soundName}).then((t=>{401===t.status&&window.location.reload()})).catch((t=>console.log(t))),t.classList.remove("btn-red"),t.classList.add("btn-green"),setTimeout((()=>t.classList.remove("btn-green")),1)}),2e3,!0),s=e((async(t=!1)=>{await fetch(`/api/skip?skipAll=${t}`,{headers:{"Content-Type":"text/plain"}}).then((t=>{401===t.status&&window.location.reload()})).catch((t=>console.log(t)))}),500,!0);let a;document.getElementById("add-sound-button"),document.getElementById("add-sound-dialog"),document.getElementById("file-upload"),document.getElementById("addsound-confirm-btn"),document.getElementById("sound-name-input"),document.getElementById("add-sound-text");const o=new class{constructor(){this.load()}list=[];save(){window.localStorage.setItem("favorites",JSON.stringify(this.list))}load(){const t=JSON.parse(window.localStorage.getItem("favorites"));t&&(this.list=t)}remove(t){this.list=this.list.filter((e=>e!==t))}toggleBtnAsFav(t){const e=t;e.classList.contains("fav-set")?(e.innerHTML="star_outline",this.remove(e.parentElement.dataset.soundName)):(e.innerHTML="star",this.list.push(e.parentElement.dataset.soundName)),e.classList.toggle("fav-set"),e.parentElement.classList.toggle("fav"),this.save()}};document.addEventListener("DOMContentLoaded",(async()=>{var t,e;a=await async function(){try{const t=await fetch("/api/user"),e=await t.json();return document.getElementById("username").innerHTML=e.name,document.getElementById("avatar").src=`https://cdn.discordapp.com/avatars/${e.userID}/${e.avatar}.png`,e}catch(t){return console.error(t),document.getElementById("body").classList.add("body-error"),document.getElementById("error-container").classList.add("message-container-show"),void document.getElementById("search-container").classList.add("search-hide")}}(),t=a.soundList,e=o,t.forEach((t=>{const n=document.createElement("div"),s=document.createElement("button"),a=document.createElement("span");a.classList.add("material-icons","favStar","icon-btn"),e.list.find((e=>e===t))?(n.classList.add("fav"),a.innerHTML="star",a.classList.add("fav-set")):a.innerHTML="star_outline",s.innerHTML=t,s.classList.add("btn","sound-btn"),n.dataset.soundName=t,n.classList.add("sound-tile"),n.appendChild(s),n.appendChild(a),document.getElementById("btn-container").appendChild(n)}))})),document.getElementById("btn-container").addEventListener("click",(t=>{t.target.classList.contains("sound-btn")&&(t.target.classList.add("btn-red"),n(t.target),setTimeout((()=>t.target.classList.remove("btn-red")),1)),t.target.classList.contains("favStar")&&o.toggleBtnAsFav(t.target)})),document.addEventListener("click",(e=>{const n=document.getElementById("log-out-menu"),a=document.getElementById("avatar");e.target===document.getElementById("skip-one")&&s(),e.target===document.getElementById("skip-all")&&s(!0),e.target===a&&n.classList.toggle("log-out-menu-hide"),e.target!==a&&n.classList.add("log-out-menu-hide"),e.target===document.getElementById("search-cancel")&&t(!0)})),document.getElementById("search").addEventListener("keyup",(()=>t())),document.getElementById("favorites-btn").addEventListener("click",(t=>{const e=Array.from(document.getElementById("btn-container").children);t.target.classList.contains("filter-btn-on")?e.forEach((t=>t.classList.remove("btn-filter-fav"))):e.forEach((t=>{t.classList.contains("fav")||t.classList.add("btn-filter-fav")})),t.target.classList.toggle("filter-btn-on")}))})();